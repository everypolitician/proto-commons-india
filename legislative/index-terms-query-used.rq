SELECT DISTINCT
  ?house ?houseLabel
  ?legislature ?legislatureLabel
  ?term ?termLabel
  ?termStart ?termEnd
  ?termSpecificPosition
WHERE {
  VALUES (?house ?position) {
    (wd:Q230003 wd:Q16556694)
    (wd:Q244730 wd:Q17324844)
    (wd:Q12429757 wd:Q24525324)
    (wd:Q15717249 wd:Q55192421)
    (wd:Q16056691 wd:Q24541525)
    (wd:Q16915317 wd:Q17598882)
    (wd:Q17152219 wd:Q24331572)
    (wd:Q17152221 wd:Q55192423)
    (wd:Q1743621 wd:Q17582810)
    (wd:Q3350930 wd:Q19007052)
    (wd:Q3391663 wd:Q24340546)
    (wd:Q3462542 wd:Q19468152)
    (wd:Q3633627 wd:Q18055586)
    (wd:Q427049 wd:Q24456735)
    (wd:Q4754369 wd:Q55192418)
    (wd:Q4808385 wd:Q21191662)
    (wd:Q4907056 wd:Q24457068)
    (wd:Q4907067 wd:Q55192419)
    (wd:Q5094831 wd:Q24457183)
    (wd:Q5253776 wd:Q24461612)
    (wd:Q5471613 wd:Q24546266)
    (wd:Q5575081 wd:Q24461695)
    (wd:Q5677950 wd:Q24497178)
    (wd:Q6148013 wd:Q55192420)
    (wd:Q6148015 wd:Q18171423)
    (wd:Q6372858 wd:Q24525419)
    (wd:Q664403 wd:Q18055681)
    (wd:Q6727600 wd:Q24529702)
    (wd:Q6733343 wd:Q18055379)
    (wd:Q6733344 wd:Q55192422)
    (wd:Q6749828 wd:Q19464087)
    (wd:Q6809008 wd:Q21191665)
    (wd:Q6884693 wd:Q24540202)
    (wd:Q7260271 wd:Q24340550)
    (wd:Q7285832 wd:Q17599276)
    (wd:Q7513808 wd:Q24547509)
    (wd:Q7681292 wd:Q24558764)
    (wd:Q7843860 wd:Q24559639)
    (wd:Q7903333 wd:Q18039836)
    (wd:Q7903335 wd:Q55192424)
    (wd:Q1195653 wd:Q58232924)
    (wd:Q12981208 wd:Q58947378)
    (wd:Q12984186 wd:Q58947430)
    (wd:Q13120036 wd:Q58947292)
    (wd:Q15277787 wd:Q58947398)
    (wd:Q16245093 wd:Q58947006)
    (wd:Q16245644 wd:Q58947090)
    (wd:Q16246043 wd:Q58947128)
    (wd:Q1651793 wd:Q58947306)
    (wd:Q16862885 wd:Q58232919)
    (wd:Q17049066 wd:Q58232923)
    (wd:Q17053972 wd:Q58947161)
    (wd:Q17054321 wd:Q58947165)
    (wd:Q17055480 wd:Q58947169)
    (wd:Q17056450 wd:Q58947185)
    (wd:Q17058405 wd:Q58947187)
    (wd:Q17071753 wd:Q58947275)
    (wd:Q17082270 wd:Q58947332)
    (wd:Q17083576 wd:Q58947113)
    (wd:Q18126899 wd:Q58947241)
    (wd:Q18359162 wd:Q58947456)
    (wd:Q18386602 wd:Q58947218)
    (wd:Q18571704 wd:Q58947319)
    (wd:Q19891622 wd:Q58947463)
    (wd:Q19891742 wd:Q58947168)
    (wd:Q19899006 wd:Q58947459)
    (wd:Q23808570 wd:Q58947232)
    (wd:Q24907066 wd:Q58947427)
    (wd:Q24929354 wd:Q58947445)
    (wd:Q24931068 wd:Q58947434)
    (wd:Q24937476 wd:Q58947221)
    (wd:Q24938237 wd:Q58947316)
    (wd:Q24938570 wd:Q58947135)
    (wd:Q24940201 wd:Q58946976)
    (wd:Q24943868 wd:Q58947087)
    (wd:Q24945941 wd:Q58947234)
    (wd:Q24945952 wd:Q58947248)
    (wd:Q24946004 wd:Q58947009)
    (wd:Q28173697 wd:Q58232921)
    (wd:Q286536 wd:Q58947092)
    (wd:Q30108922 wd:Q58947013)
    (wd:Q30262990 wd:Q58947347)
    (wd:Q39054349 wd:Q58947289)
    (wd:Q4045640 wd:Q58947093)
    (wd:Q4045694 wd:Q58947268)
    (wd:Q4045808 wd:Q58947343)
    (wd:Q4691381 wd:Q58946974)
    (wd:Q4696118 wd:Q58946982)
    (wd:Q4696137 wd:Q58946979)
    (wd:Q4701517 wd:Q58946986)
    (wd:Q4822112 wd:Q58947015)
    (wd:Q48724072 wd:Q58947118)
    (wd:Q48726994 wd:Q58947450)
    (wd:Q4882408 wd:Q58947039)
    (wd:Q4978693 wd:Q58232916)
    (wd:Q5172540 wd:Q58947236)
    (wd:Q5196921 wd:Q58947103)
    (wd:Q5259597 wd:Q58232918)
    (wd:Q55603645 wd:Q58946988)
    (wd:Q55621426 wd:Q58947265)
    (wd:Q5621998 wd:Q58947164)
    (wd:Q58231276 wd:Q58232917)
    (wd:Q58942498 wd:Q58946983)
    (wd:Q58942501 wd:Q58946984)
    (wd:Q58942503 wd:Q58946989)
    (wd:Q58942504 wd:Q58947003)
    (wd:Q58942506 wd:Q58947004)
    (wd:Q58942508 wd:Q58947008)
    (wd:Q58942510 wd:Q58947010)
    (wd:Q58942512 wd:Q58947016)
    (wd:Q58942514 wd:Q58947030)
    (wd:Q58942529 wd:Q58947031)
    (wd:Q58942530 wd:Q58947033)
    (wd:Q58942534 wd:Q58947035)
    (wd:Q58942536 wd:Q58947036)
    (wd:Q58942537 wd:Q58947038)
    (wd:Q58942539 wd:Q58947042)
    (wd:Q58942542 wd:Q58947044)
    (wd:Q58942544 wd:Q58947055)
    (wd:Q58942545 wd:Q58947056)
    (wd:Q58942561 wd:Q58947059)
    (wd:Q58942563 wd:Q58947061)
    (wd:Q58942565 wd:Q58947062)
    (wd:Q58942568 wd:Q58947064)
    (wd:Q58942569 wd:Q58947066)
    (wd:Q58942571 wd:Q58947067)
    (wd:Q58942573 wd:Q58947068)
    (wd:Q58942576 wd:Q58947079)
    (wd:Q58942577 wd:Q58947081)
    (wd:Q58942593 wd:Q58947082)
    (wd:Q58942597 wd:Q58947084)
    (wd:Q58942598 wd:Q58947086)
    (wd:Q58942600 wd:Q58947106)
    (wd:Q58942603 wd:Q58947108)
    (wd:Q58942604 wd:Q58947110)
    (wd:Q58942606 wd:Q58947111)
    (wd:Q58942609 wd:Q58947114)
    (wd:Q58942610 wd:Q58947116)
    (wd:Q58942624 wd:Q58947131)
    (wd:Q58942626 wd:Q58947132)
    (wd:Q58942629 wd:Q58947136)
    (wd:Q58942631 wd:Q58947137)
    (wd:Q58942633 wd:Q58947141)
    (wd:Q58942634 wd:Q58947142)
    (wd:Q58942638 wd:Q58947155)
    (wd:Q58942640 wd:Q58947158)
    (wd:Q58942641 wd:Q58947160)
    (wd:Q58942660 wd:Q58947163)
    (wd:Q58942661 wd:Q58947182)
    (wd:Q58942662 wd:Q58947183)
    (wd:Q58942665 wd:Q58947193)
    (wd:Q58942667 wd:Q58947194)
    (wd:Q58942668 wd:Q58947196)
    (wd:Q58942669 wd:Q58947197)
    (wd:Q58942674 wd:Q58947209)
    (wd:Q58942675 wd:Q58947212)
    (wd:Q58942692 wd:Q58947213)
    (wd:Q58942695 wd:Q58947214)
    (wd:Q58942697 wd:Q58947217)
    (wd:Q58942698 wd:Q58947223)
    (wd:Q58942701 wd:Q58947233)
    (wd:Q58942703 wd:Q58947242)
    (wd:Q58942705 wd:Q58947247)
    (wd:Q58942708 wd:Q58947262)
    (wd:Q58942710 wd:Q58947271)
    (wd:Q58942725 wd:Q58947272)
    (wd:Q58942727 wd:Q58947276)
    (wd:Q58942729 wd:Q58947277)
    (wd:Q58942732 wd:Q58947294)
    (wd:Q58942734 wd:Q58947297)
    (wd:Q58942736 wd:Q58947300)
    (wd:Q58942738 wd:Q58947302)
    (wd:Q58942742 rdf:nil)
    (wd:Q58942744 wd:Q58947321)
    (wd:Q58942759 wd:Q58947323)
    (wd:Q58942762 wd:Q58947325)
    (wd:Q58942765 wd:Q58947326)
    (wd:Q58942766 wd:Q58947328)
    (wd:Q58942768 wd:Q58947331)
    (wd:Q58942771 wd:Q58947345)
    (wd:Q58942775 wd:Q58947348)
    (wd:Q58942778 wd:Q58947351)
    (wd:Q58942791 wd:Q58947353)
    (wd:Q58942793 wd:Q58947355)
    (wd:Q58942795 wd:Q58947365)
    (wd:Q58942797 wd:Q58947367)
    (wd:Q58942799 wd:Q58947370)
    (wd:Q58942801 wd:Q58947372)
    (wd:Q58942803 wd:Q58947375)
    (wd:Q58942806 wd:Q58947379)
    (wd:Q58942808 wd:Q58947382)
    (wd:Q58942824 wd:Q58947383)
    (wd:Q58942825 wd:Q58947392)
    (wd:Q58942828 wd:Q58947394)
    (wd:Q58942830 wd:Q58947396)
    (wd:Q58942831 wd:Q58947403)
    (wd:Q58942834 wd:Q58947405)
    (wd:Q58942836 wd:Q58947408)
    (wd:Q58942837 wd:Q58947425)
    (wd:Q58942841 wd:Q58947426)
    (wd:Q58942851 wd:Q58947431)
    (wd:Q6124132 wd:Q58947190)
    (wd:Q6354838 wd:Q58947222)
    (wd:Q6427229 wd:Q58947238)
    (wd:Q6497204 wd:Q58947260)
    (wd:Q6936218 wd:Q58947140)
    (wd:Q6959016 wd:Q58947301)
    (wd:Q6966849 wd:Q58947305)
    (wd:Q7194723 wd:Q58947341)
    (wd:Q7286279 wd:Q58947349)
    (wd:Q7555808 wd:Q58947400)
    (wd:Q7645445 wd:Q58947409)
    (wd:Q7710242 wd:Q58947419)
    (wd:Q7785507 wd:Q58947420)
    (wd:Q7798279 wd:Q58947422)
    (wd:Q7878932 wd:Q58947446)
    (wd:Q7908340 wd:Q58947448)
    (wd:Q7916307 wd:Q58947454)
  }
  ?house (p:P361/ps:P361)* ?legislature .
      ?baseTerm p:P31|p:P279 [ ps:P279|ps:P31 wd:Q15238777 ; pq:P642 ?legislature ] .
      OPTIONAL { ?subTerm wdt:P31 ?baseTerm }

  BIND(COALESCE(?subTerm, ?baseTerm) AS ?term)

  OPTIONAL { ?term (wdt:P580|wdt:P571) ?termStart. }
  OPTIONAL { ?term (wdt:P582|wdt:P576) ?termEnd. }
  OPTIONAL { ?term (wdt:P155|wdt:P1365) ?termReplaces }
  OPTIONAL { ?term (wdt:P156|wdt:P1366) ?termReplacedBy }
  OPTIONAL {
    ?termSpecificPosition wdt:P31/wdt:P279* wd:Q4164871 ;
                          p:P279 [ ps:P279 ?position ;
                                   pq:P2937 ?term ] .
  }

  # Only include terms without end dates or whose end dates are in the future
  FILTER (!BOUND(?termEnd) || ?termEnd > NOW())
  # Only include terms which haven't been replaced unless they have end dates
  # (and so by implication, as per above, have end dates in the future)
  FILTER (!BOUND(?termReplacedBy) || BOUND(?termEnd))
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en,hi". }
} ORDER BY ?termStart ?term
